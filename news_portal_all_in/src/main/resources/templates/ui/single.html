<!DOCTYPE html>

<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="fragments/header :: head"></head>

<body class="skin-orange">
<!-- HEADER -->
<header class="primary" >
	<div th:replace="fragments/header :: firstbar"></div>
	<nav th:replace="fragments/header :: nav"></nav>
</header>
<!-- /HEADER -->
		<section class="single">
			<div class="container">
				<div class="row">
					<div class="col-md-4 sidebar" id="sidebar">
						<aside>
							<div class="aside-body">
								<figure class="ads">
									<img src="../images/ad.png" th:src="@{/images/ad.png}">
									<figcaption>Advertisement</figcaption>
								</figure>
							</div>
						</aside>
						<aside>
							<h1 class="aside-title">Recent Post</h1>
							<div class="aside-body">

								<div th:replace="fragments/news :: resent_post"></div>

								<div class="line"></div>
									<div class="body-col vertical-slider" data-max="3" data-nav="#hot-resent-post" data-item="article">
										<div th:replace="fragments/news :: article_mini_three"></div>
									</div>
							</div>
						</aside>
						<aside>
							<div class="aside-body">
								<form class="newsletter">
									<div class="icon">
										<i class="ion-ios-email-outline"></i>
										<h1>Newsletter</h1>
									</div>
									<div class="input-group">
										<input type="email" class="form-control email" placeholder="Your mail">
										<div class="input-group-btn">
											<button class="btn btn-primary"><i class="ion-paper-airplane"></i></button>
										</div>
									</div>
									<p>By subscribing you will receive new articles in your email.</p>
								</form>
							</div>
						</aside>
					</div>
					<div class="col-md-8">
						<br>
						<ol class="breadcrumb">
						  <li><a href="#" th:href="@{/}">Home</a></li>
						  <li class="active" th:utext="${article.category.name}">Film</li>
						</ol>
						<article class="article main-article">
							<header>
								<h1 th:text="${article.title}">Title.</h1>
								<ul class="details">
									<li th:remove="tag" th:utext="${#temporals.format(article.created, 'dd-MMM-yyyy HH:mm')}">Posted on 31 December, 2016</li>
<!--									<li th:remove="tag" th:utext="${#dates.format(article.created, 'dd-MMM-yyyy')}">Posted on 31 December, 2016</li>-->
									<li><a  th:href="@{'/search?cat_id=' + ${article.category.id}}" th:utext="${article.category.name}">Film</a></li>
									<li th:text="${article.author}">By John Doe </li>
									<!--вывод списка авторов-->
<!--									<li th:if="${article.authors.size()==1}" >Автор</li>-->
<!--									<li th:if="${article.authors.size()>1}" >Авторы</li>-->
<!--									<div th:each="writer:${article.authors}">-->
<!--										<li><a th:href="@{/user/edituser/{username}(username=${writer.username})}" th:utext="${writer.username}">А.С.Пушкин</a></li>-->
<!--									</div>-->
								</ul>
							</header>
							<div class="main">
								<p  th:remove="tag" th:utext="${article.text}">Text Article</p>
								<div class="featured">
									<figure>
										<figcaption>Image by pexels.com</figcaption>
									</figure>
								</div>

								<p>Nulla facilisi. Aenean pharetra fringilla nunc a finibus. Nulla vitae pretium nunc. Pellentesque sagittis sollicitudin turpis id aliquam. Cras lobortis diam in nunc posuere, et malesuada sem gravida. Curabitur ornare massa id orci faucibus elementum. Phasellus pharetra, velit <a href="#">in egestas rutrum,</a> metus dolor maximus massa, feugiat molestie eros mauris sit amet massa. Maecenas blandit diam lacus, in luctus nulla efficitur nec. Sed sit amet quam sit amet odio scelerisque vestibulum vel sit amet ante. Cras fringilla efficitur lacinia. Cras posuere, arcu id consequat ultrices, urna urna cursus massa, at sollicitudin elit lacus quis dui. In laoreet nulla a turpis blandit sollicitudin. Donec in risus eu lorem volutpat hendrerit quis non lorem. Nulla in metus ipsum.
								<p>Etiam sit amet augue non velit aliquet consectetur. Proin gravida, odio in facilisis pharetra, neque enim aliquam eros, vitae gravida orci elit vel magna. Integer viverra a purus id gravida. Donec laoreet mi ac auctor ultricies. Pellentesque ullamcorper est et erat ullamcorper gravida. In hac habitasse platea dictumst. Pellentesque justo mauris, mollis at tortor ut, commodo venenatis elit. Curabitur suscipit pellentesque nunc, id tempus mi facilisis sed. Curabitur molestie eu odio vitae condimentum. Donec placerat tristique neque a blandit. Nullam commodo massa ut eros elementum, in suscipit libero aliquam.</p>

								<h4>Sed id sodales sapien. Interdum et malesuada fames ac ante ipsum primis in faucibus. Nulla facilisi.</h4>
								<p>Nulla facilisi. Duis auctor fringilla sagittis. Fusce ornare, dui id consequat volutpat, nibh metus viverra nibh, vitae bibendum diam velit in libero. Sed dignissim quam sit amet nibh porttitor, non pellentesque metus tincidunt. Maecenas non velit sapien. </p>
								<p>Maecenas vel dolor sit amet ligula interdum tempor id eu ipsum. Suspendisse pharetra risus ut metus elementum pulvinar. Mauris eget varius tellus. Cras et lorem vel nunc gravida porttitor.</p>
								<blockquote>
									Free Responsive HTML5 &amp; CSS3 Magazine Template
								</blockquote>
								<p>Ut est elit, vehicula tempus volutpat ut, sodales eget odio. Nunc placerat, orci ac iaculis feugiat, sem tellus efficitur tortor, mollis iaculis lacus ante nec risus. Sed consequat vehicula pretium.</p>
							</div>
							<footer>
								<div class="col">
									<ul class="tags">
										<li  th:each="tag,state : ${article.tags}" >
											<a th:href="@{/search/tag/{id}(id=${tag.id})}" th:text="${tag.name}">Free Themes</a></li>
									</ul>
								</div>
								<!--вывод средней оценки-->
								<div class="col_comments" th:text="#{rate.average_value}">Средняя оценка</div>
									<div class="col_comments" style="margin-left:5px;" th:text="${@articleRatingService.getAverageValueOfArticle(article.id)}">4.567</div>
								<!--проставление оценки статьи пользователями (рейтинг)-->
								<form sec:authorize="isAuthenticated()"
									  th:action="@{/single/articles/add/rating/{article_id}(article_id = ${article.id})}"
									  method="post">
									<div class="col_comments">
										<input th:name="article_value_by_user" th:checked="${user_value == 1}"
											   type="radio" th:value=1>1&nbsp;
										<input th:name="article_value_by_user" th:checked="${user_value == 2}"
											   type="radio" th:value=2>2&nbsp;
										<input th:name="article_value_by_user" th:checked="${user_value == 3}"
											   type="radio" th:value=3>3&nbsp;
										<input th:name="article_value_by_user" th:checked="${user_value == 4}"
											   type="radio" th:value=4>4&nbsp;
										<input th:name="article_value_by_user" th:checked="${user_value == 5}"
											   type="radio" th:value=5>5&nbsp;
										<button type="submit" class="btn btn-primary" th:text="#{rate.evaluate}">Оценить
											тест
										</button>
									</div>
								</form>
								<!--лайки и дизлайки-->
								<div class="col_comments" sec:authorize="isAuthenticated()">
									<a class="love" th:href="@{/single/articles/add/like/{id}(id = ${article.id})}">
										<i class="fa fa-thumbs-up" th:text="${articleLikes}">2333</i>
									</a>&nbsp;&nbsp;&nbsp;
									<a class="love" th:href="@{/single/articles/add/dislike/{id}(id = ${article.id})}">
										<i class="fa fa-thumbs-down" th:text="${articleDislikes}">213</i>
									</a>
								</div>
								<!--для неавторизованных пользователей кнопки с лайками должны быть недоступны-->
								<div class="col_comments" sec:authorize="isAnonymous()">
									<i class="love fa fa-thumbs-up" th:text="${articleLikes}">2333</i>
									<i class="love fa fa-thumbs-down" th:text="${articleDislikes}">213</i>
								</div>
							</footer>
						</article>
						<div class="sharing">
						<div class="title"><i class="ion-android-share-alt"></i> Sharing is caring</div>
							<ul class="social">
								<li>
									<a href="#" class="facebook">
										<i class="ion-social-facebook"></i> Facebook
									</a>
								</li>
								<li>
									<a href="#" class="twitter">
										<i class="ion-social-twitter"></i> Twitter
									</a>
								</li>
								<li>
									<a href="#" class="googleplus">
										<i class="ion-social-googleplus"></i> Google+
									</a>
								</li>
								<li>
									<a href="#" class="linkedin">
										<i class="ion-social-linkedin"></i> Linkedin
									</a>
								</li>
								<li>
									<a href="#" class="skype">
										<i class="ion-ios-email-outline"></i> Email
									</a>
								</li>
								<li class="count">
									20
									<div>Shares</div>
								</li>
							</ul>
						</div>
						<div class="line">
							<div>Author</div>
						</div>
						<div class="author">
							<figure>
								<img src="../images/img01.jpg" th:src="@{/images/img01.jpg}">
							</figure>
							<div class="details">
								<div class="job">Web Developer</div>
								<h3 class="name" th:text="${article.author}">John Doe</h3>
								<p>Nulla sagittis rhoncus nisi, vel gravida ante. Nunc lobortis condimentum elit, quis porta ipsum rhoncus vitae. Curabitur magna leo, porta vel fringilla gravida, consectetur in libero. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum.</p>
								<ul class="social trp sm">
									<li>
										<a href="#" class="facebook">
											<svg><rect/></svg>
											<i class="ion-social-facebook"></i>
										</a>
									</li>
									<li>
										<a href="#" class="twitter">
											<svg><rect/></svg>
											<i class="ion-social-twitter"></i>
										</a>
									</li>
									<li>
										<a href="#" class="youtube">
											<svg><rect/></svg>
											<i class="ion-social-youtube"></i>
										</a>
									</li>
									<li>
										<a href="#" class="googleplus">
											<svg><rect/></svg>
											<i class="ion-social-googleplus"></i>
										</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="line"><div>You May Also Like</div></div>
						<div class="row" >

							<div th:replace="fragments/news :: like_news"></div>

						</div>
						<div class="line thin"></div>
						<div class="comments">
									<h2 class="title" sec:authorize="isAnonymous()" ><span th:text="${tree_comments.size()-1}"></span> Responses<a th:href="@{/login}" >Registered user write a Response</a></h2>
									<h2 class="title" sec:authorize="isAuthenticated()" ><span th:text="${tree_comments.size()-1}"></span> Responses <a href="#reply" >Write a Response</a></h2>

							<!--							форма для отправки комментария-->
							<form class="row" sec:authorize="isAuthenticated()"
								  th:action="@{/single/articles/comment/{article_id}(article_id = ${article.id})}"
								  th:object="${comment}" method="post" >
								<a name="reply"></a>
								<div class="col-md-12">
									<h3 class="title">Leave Your Response</h3>
								</div>

								<div class="form-group col-md-12">
									<label for="message">Response <span class="required"></span></label>
									<textarea class="form-control" name="message" placeholder="Write your response ..." th:field="*{text}"></textarea>
								</div>
								<div class="form-group col-md-12">
									<button type="submit" class="btn btn-primary">Send Response</button>
								</div>
							</form>

<!--						выводим дерево комментариев(начало)-->
							<div id="multi-derevo">
							<section th:include="fragments/comment_fragment.html :: comments" th:with="comments=${@commentService.getChildren(tree_comments,null)}"></section>
							</div>
<!--						выводим дерево комментариев(конец)-->

						</div>
					</div>
				</div>
			</div>
		</section>

	<!-- FOOTER -->
	<footer th:replace="fragments/footer :: footer"></footer>
	<!-- /FOOTER -->

	<!-- JS -->
	<script th:remove="tag" th:replace="fragments/scripts :: scripts"> </script>

<!--для отображения шрифтов для лайков и дизлайков-->
<script src="https://use.fontawesome.com/2010e27091.js"></script>
	</body>
</html>